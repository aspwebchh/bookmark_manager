///<reference path="scripts/jquery/jquery.d.ts" />
///<reference path="scripts/bookmark_right_click_menu.ts" />
///<reference path="scripts/bookmark_container.ts" />
///<reference path="scripts/bookmark_page_list.ts" />
var BookMark;
(function (BookMark) {
    var Main = (function () {
        function Main() {
            this.bookMarkNavManager = new BookMark.BookMarkManager();
            this.bookMarkPageList = new BookMark.BookMarkPageList();
            this.pageListRightClickMenu = new BookMark.PageListRightClickMenu();
            this.initNavMenu();
            this.initPageList();
            this.initForManagerWindow();
        }
        Main.prototype.initForManagerWindow = function () {
            $("#manager").bind("click", function () {
                var wnd = window.open("", "_blank", "height=800, width=1000, top=200,left=200, toolbar =no, menubar=no, scrollbars=no, resizable=no, location=no, status=no");
                wnd.document.write("<!DOCTYPE html>\n                                        <html>\n                                        <head>\n                                            <link href=\"app.css\" rel=\"stylesheet\" type=\"text/css\" />\n                                        </head>\n                                        <body>\n\n                                            <div class=\"nav\">\n                                                <ul id=\"bookmark_nav\"></ul>\n                                            </div>\n                                            <div class=\"page_list\" id=\"page_list\">\n   \n                                            </div>\n\n                                            <script type=\"text/javascript\" src=\"scripts/jquery-1.9.1.min.js\"></script>\n                                            <script type=\"text/javascript\" src=\"scripts/bookmark_right_click_menu.js\"></script>\n                                            <script type=\"text/javascript\" src=\"scripts/bookmark_container.js\"></script>\n                                            <script type=\"text/javascript\" src=\"scripts/bookmark_page_list.js\"></script>\n                                             <script type=\"text/javascript\" src=\"app.js\"></script>\n                                            <script type=\"text/javascript\">\n\n                                            </script>\n\n                                            <a href=\"javascript:;\" target=\"_blank\" id=\"manager\">\u7BA1\u7406</a>\n\n                                            <script type=\"text/javascript\">\n\n                                            </script>\n                                        </body>\n                                        </html>");
            });
        };
        Main.prototype.initNavMenu = function () {
            var _this = this;
            this.bookMarkNavRightMenu = new BookMark.BookMarkRightClickMenu();
            this.bookMarkNavRightMenu.onAddDir = function () {
                var node = _this.bookMarkNavRightMenu.getTargetNode();
                _this.bookMarkNavManager.newItem(node.getSource().id);
            };
            this.bookMarkNavRightMenu.onAddPage = function () {
                _this.bookMarkPageList.newItem();
            };
            this.bookMarkNavRightMenu.onDel = function () {
                var node = _this.bookMarkNavRightMenu.getTargetNode();
                _this.bookMarkNavManager.removeItem(node.getSource().id);
            };
            this.bookMarkNavRightMenu.onRename = function () {
                var node = _this.bookMarkNavRightMenu.getTargetNode();
                node.getSource().state = BookMark.BookMarkDataItemState.Rename;
                _this.bookMarkNavManager.reRender();
            };
            this.bookMarkNavRightMenu.render();
            this.bookMarkNavManager = new BookMark.BookMarkManager();
            this.bookMarkNavManager.onRightClick = function (node, e) {
                var offset = node.getNodeElement().offset();
                _this.bookMarkNavRightMenu.show(e.pageX + 2, e.pageY + 2);
                _this.bookMarkNavRightMenu.setTargetNode(node);
                _this.pageListRightClickMenu.hide();
            };
            this.bookMarkNavManager.onRename = function (node) {
                console.log(node.getSource());
            };
            this.bookMarkNavManager.onMove = function () {
                console.log(_this.bookMarkNavManager.getDataSource());
            };
            this.bookMarkNavManager.addBookMarkData({ id: 0, pid: -1, title: "" });
            this.bookMarkNavManager.addBookMarkData({ id: 1, pid: 0, title: "\u76EE\u5F551" });
            this.bookMarkNavManager.addBookMarkData({ id: 2, pid: 0, title: "\u76EE\u5F552" });
            this.bookMarkNavManager.addBookMarkData({ id: 3, pid: 0, title: "\u76EE\u5F553" });
            this.bookMarkNavManager.addBookMarkData({ id: 11, pid: 1, title: "\u76EE\u5F5511" });
            this.bookMarkNavManager.addBookMarkData({ id: 12, pid: 1, title: "\u76EE\u5F5512" });
            this.bookMarkNavManager.addBookMarkData({ id: 21, pid: 2, title: "\u76EE\u5F5521" });
            this.bookMarkNavManager.addBookMarkData({ id: 22, pid: 2, title: "\u76EE\u5F5522" });
            this.bookMarkNavManager.addBookMarkData({ id: 211, pid: 21, title: "\u76EE\u5F55211" });
            this.bookMarkNavManager.addBookMarkData({ id: 212, pid: 21, title: "\u76EE\u5F55212" });
            this.bookMarkNavManager.onNodeClick = function (arg) {
                _this.bookMarkPageList.empty();
                _this.bookMarkPageList.add({ id: 1, title: "\u65B0\u6D6A\u7F51", url: "http://www.sina.com/" });
                _this.bookMarkPageList.reRender();
            };
            this.bookMarkNavManager.render("bookmark_nav");
        };
        Main.prototype.initPageList = function () {
            var _this = this;
            var selectedBookMarkPageDataItem;
            this.bookMarkPageList.add({ id: 1, title: "\u65B0\u6D6A\u7F51", url: "http://www.sina.com/" });
            this.bookMarkPageList.add({ id: 5, title: "\u65B0\u6D6A\u7F511", url: "http://www.sina.com/" });
            this.bookMarkPageList.add({ id: 3, title: "\u65B0\u6D6A\u7F512", url: "http://www.sina.com/" });
            this.bookMarkPageList.add({ id: 4, title: "\u65B0\u6D6A\u7F513", url: "http://www.sina.com/" });
            this.bookMarkPageList.render("page_list");
            this.bookMarkPageList.onItemAdd = function (data) {
                console.log(data);
            };
            this.bookMarkPageList.onItemEdit = function (data) {
                console.log(data);
            };
            this.bookMarkPageList.onItemDel = function (data) {
                console.log(data);
            };
            this.bookMarkPageList.onRightClick = function (e, dataItem) {
                selectedBookMarkPageDataItem = dataItem;
                _this.pageListRightClickMenu.show(e.pageX, e.pageY);
                _this.bookMarkNavRightMenu.hide();
            };
            this.pageListRightClickMenu.render();
            this.pageListRightClickMenu.onDel = function () {
                _this.bookMarkPageList.removeItem(selectedBookMarkPageDataItem.id);
            };
            this.pageListRightClickMenu.onEdit = function () {
                _this.bookMarkPageList.editItem(selectedBookMarkPageDataItem.id);
            };
            this.pageListRightClickMenu.onOpen = function () {
                window.open(selectedBookMarkPageDataItem.url);
            };
        };
        return Main;
    }());
    new Main();
})(BookMark || (BookMark = {}));
//# sourceMappingURL=app.js.map